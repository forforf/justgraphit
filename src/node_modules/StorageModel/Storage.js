
import History from './History';

// ToDo Needs testing

class Storage {

  constructor() {
    this.store = {};
    this.history = new History(2);
  }
  
  getAll() { return this.store; };
  
  getLastKey() {
    return this.history.getLast();
  }

  // returns key and data
  // TODO: Rename to getLastStorageObj()
  getLastKeyValue() {
    let obj = {}
    const key = this.getLastKey();
    const val = this.load( key );
    // return {key: key, value: val}
    obj[key] = val;
    return obj;
  };

  isEmpty() {
    return Object.keys(this.store).length === 0;
  }

  load(key) {
    // this.updateHistory(key);
    return this.store[key];
  };

  save(key, val) {
    this.updateHistory(key);
    this.store[key] = val;
    return key;
  };
  
  updateHistory(key) {
    console.log('Storage updateHistory', key);
    if (key && key.length) {
      console.log('saving to history:', key);
      this.history.push(key);
    }

  }
}

export default Storage;
